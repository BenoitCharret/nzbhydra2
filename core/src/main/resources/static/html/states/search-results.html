<div class="row" ng-if="indexersearches.length" style="margin-top: 25px">

    <div class="col-md-5"></div>
    <div class="col-md-10" style="padding-right: 0px">
        <!-- TODO: Make box smaller if no error messages exist-->
        <uib-accordion close-others="oneAtATime">
            <div uib-accordion-group panel-class="panel-indexer-statuses" is-open="foo.indexerStatusesExpanded" is-disabled="true" class="">
                <uib-accordion-heading>
                    <span class="indexer-statuses-accordion">
                        <span ng-click="toggleIndexerStatuses()">Indexer statuses</span><span ng-if="countRejected > 0"> / Rejected results</span> <i class="pull-right glyphicon"
                                                                                                                                                      ng-class="{'glyphicon-chevron-down': foo.indexerStatusesExpanded, 'glyphicon-chevron-right': !foo.indexerStatusesExpanded}"
                                                                                                                                                      ng-click="toggleIndexerStatuses()"></i>
                    </span>
                </uib-accordion-heading>

                <table class="table">
                    <thead>
                    <tr>
                        <th class="col-md-6 text-left">
                            Indexer
                        </th>
                        <th class="col-md-2 text-left">
                            Results
                        </th>
                        <th class="col-md-4 text-left">
                            Response time
                        </th>
                        <th class="col-md-9 text-left">
                            Status
                        </th>

                    </tr>
                    </thead>

                    <tbody>
                    <tr ng-repeat-start="ps in indexersearches " ng-if="0"></tr>
                    <!-- First result in the list, show regularly -->
                    <tr>
                        <td class="text-left">
                            {{ ps.indexerName }}
                        </td>
                        <td class="text-left">
                    <span ng-if="ps.didSearch">
                        <span ng-if="!ps.totalResultsKnown && ps.numberOfAvailableResults > 0">&gt;</span>{{ ps.numberOfAvailableResults }}
                    </span>
                        </td>
                        <td class="text-left">
                    <span ng-if="ps.didSearch">
                        {{ ps.responseTime }}ms
                    </span>
                        </td>
                        <td class="text-left">
                    <span ng-if="::ps.didSearch">
                        <span class="glyphicon" ng-class="{'glyphicon-ok' : ps.wasSuccessful, 'glyphicon-remove' : !ps.wasSuccessful}"></span>

                            <span ng-if="::!ps.wasSuccessful">{{ ps.errorMessage }}</span>
                        </span>
                            </span>
                            <span ng-if="::!ps.didSearch">
                        Did not search.
                    </span>
                        </td>
                    </tr>
                    <tr ng-repeat-end ng-if="0"></tr>


                    <tr ng-repeat-start="ps in notPickedIndexersWithReason" ng-if="0"></tr>
                    <tr>
                        <td class="text-left">
                            {{ ps.indexer }}
                        </td>
                        <td class="text-left">
                        </td>
                        <td class="text-left">
                        </td>
                        <td class="text-left">
                            <span class="glyphicon glyphicon-minus"></span>
                            {{ps.reason}}
                        </td>
                    </tr>
                    <tr ng-repeat-end ng-if="0"></tr>


                    </tbody>
                </table>

                <table class="table" style="margin-bottom: 0px; margin-top: 5px" ng-if="countRejected > 0">
                    <thead>
                    <tr>
                        <th class="col-md-5 text-left">
                        </th>
                        <th class="col-md-5 text-left" style="text-align: right">
                            Reject reason
                        </th>
                        <th class="col-md-5 text-left">
                            Count
                        </th>
                        <th class="col-md-5 text-left">
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="entry in rejected | filter: filterRejectedZero(entry)">
                        <td>
                        </td>
                        <td style="text-align: right">
                            {{ entry[0] }}
                        </td>
                        <td>
                            {{ entry[1] }}
                        </td>
                        <td>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </uib-accordion>
    </div>
</div>

<div class="row" ng-if="::indexersearches.length == 0" style="margin-top: 50px">
    <div class="well">
        <h2>No indexers were picked for this search</h2>
        <div style="width: 520px; margin: auto;text-align: left;">
            Reasons:
            <ul style="padding-left: 15px">
                <li ng-repeat="tuple in ::notPickedIndexersWithReason">{{tuple.indexer}}: {{tuple.reason}}</li>
            </ul>
        </div>
    </div>
</div>
<div class="row" ng-if="::indexersearches.length > 0 && numberOfAvailableResults === 0" style="margin-top: 50px">
    <div class="well">
        <h2>No results were found for this search</h2>
    </div>
</div>
<div class="row" ng-if="::indexersearches.length > 0 && numberOfAvailableResults > 0" style="margin-top: 10px">
    <div class="col-md-8" style="text-align: left;">
        <input style="margin-top:20px; margin-bottom:20px;" type="checkbox" ng-model="foo.duplicatesDisplayed" ng-click="toggleDuplicatesDisplayed()" class="btn btn-default">Show duplicates</input>
        <button class="btn btn-default" ng-click="invertSelection()">Invert selection</button>
        <download-nzbs-button search-results="selected"></download-nzbs-button>
        <download-nzbzip-button search-results="selected" search-title="searchTitle"></download-nzbzip-button>
    </div>

    <div class="col-md-4" style="margin-top: 20px">
        <dir-pagination-controls auto-hide="false" max-size="5"></dir-pagination-controls>
    </div>
    <div class="col-md-8" style="text-align: right;">
        <span class="badge"
              uib-tooltip-html="getRejectedReasonsTooltip()"
              tooltip-class="rejected-tooltip"
              tooltip-placement="top"
              tooltip-trigger="click"
        >Loaded {{ numberOfLoadedResults }} of {{ numberOfAvailableResults }} results (
            rejected {{ numberOfRejectedResults }}
            )</span>

        <div class="btn-group" style="margin-top:20px; margin-bottom:20px;">
            <button type="button" ng-click="loadMore(false)" class="btn btn-default" ng-disabled="numberOfLoadedResults + numberOfRejectedResults >= numberOfAvailableResults"
                    uib-tooltip="Click to load more results from the indexers"
                    tooltip-placement="top"
                    tooltip-trigger="mouseenter"
            >Load more
            </button>
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                    ng-disabled="numberOfLoadedResults + numberOfRejectedResults >= numberOfAvailableResults">
                <span class="caret"></span>
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
                <li><a href="#" ng-click="loadMore(true)"
                       uib-tooltip="Click to load all of the results from the indexers. May take a while and a lot of API requests..."
                       tooltip-placement="top"
                       tooltip-trigger="mouseenter"
                >Load all results</a></li>
            </ul>
        </div>
    </div>

    <table class="search-results-table table">
        <thead class="search-results-header">
        <tr class="search-results-row">
            <th class="col-md-12 cursor-default search-results-cell result-title">
                <column-sortable column="title" reversed="false" start-mode="1">Title
                </column-sortable>
                <column-filter-wrapper>
                    <freetext-filter column="title"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-1 cursor-default search-results-cell result-indexer" style="vertical-align: top; text-align: right">
                <column-sortable column="indexer" reversed="false" start-mode="1">Indexer
                </column-sortable>
                <column-filter-wrapper>
                    <checkboxes-filter column="indexer" entries="indexersForFiltering" preselect="true" show-invert="true"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-1 cursor-default search-results-cell result-category" style="vertical-align: top; text-align: right">
                <column-sortable column="category" reversed="false" start-mode="1">Category
                </column-sortable>
                <column-filter-wrapper>
                    <checkboxes-filter column="category" entries="categoriesForFiltering" preselect="true" show-invert="true"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-1 cursor-default search-results-cell result-size" style="vertical-align: top; text-align: right">
                <column-sortable column="size" reversed="false" start-mode="2">Size
                </column-sortable>
                <column-filter-wrapper>
                    <number-range-filter column="size" addon="MB"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-1 cursor-default search-results-cell result-details" style="vertical-align: top; text-align: right">
                <column-sortable column="grabs" reversed="false" start-mode="2">Grabs
                </column-sortable>
                <column-filter-wrapper>
                    <number-range-filter column="grabs"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-1 cursor-default search-results-cell result-age" style="vertical-align: top; text-align: right">
                <column-sortable column="epoch" reversed="true" start-mode="2">Age
                </column-sortable>
                <column-filter-wrapper>
                    <number-range-filter column="epoch" addon="days"/>
                </column-filter-wrapper>
            </th>
            <th class="col-md-3 search-results-cell result-links" style="vertical-align: top">
                Links
            </th>
        </tr>
        </thead>

        <tbody dir-paginate-start="titleGroup in filteredResults | itemsPerPage:limitTo track by groupId(titleGroup)" ng-show="0"></tbody>

        <tbody title-group titles="titleGroup" selected="selected" style="display: table-row-group" row-index="$index" do-show-duplicates="foo.duplicatesDisplayed"></tbody>

        <tbody dir-paginate-end ng-show="0"></tbody>

    </table>
    <dir-pagination-controls auto-hide="false"></dir-pagination-controls>
</div>